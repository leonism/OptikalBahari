<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "{% if page.type %}{{ page.type | strip }}{% elsif page.is_post %}BlogPosting{% else %}WebPage{% endif %}",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ page.url | prepend: site.baseurl | prepend: site.url }}"
  },
  {% if page.title %}"name": "{{ page.title | escape }}",{% endif %}
  {% if page.description %}"description": "{{ page.description | strip_html | strip_newlines | escape }}",{% endif %}
  "author": {
    "@type": "Person",
    "name": "{{ page.author | default: site.author | strip | escape }}"
  },
  {% if page.date %}"datePublished": "{{ page.date | date_to_xmlschema }}",{% endif %}
  {% if page.breadcrumbs %}
  "breadcrumb": {
    "@type": "BreadcrumbList",
    "itemListElement": [
      {% for breadcrumb in page.breadcrumbs %}
      {
        "@type": "ListItem",
        "position": {{ forloop.index }},
        "item": {
          "@id": "{{ breadcrumb.url | replace: 'page.url', page.url | prepend: site.baseurl | prepend: site.url | strip }}",
          "name": "{{ breadcrumb.title | replace: 'page.title', page.title | strip | escape }}"
        }
      }{% unless forloop.last %},{% endunless %}
      {% endfor %}
    ]
  },
  {% endif %}
  "url": "{{ page.url | prepend: site.baseurl | prepend: site.url }}"
}
</script>
